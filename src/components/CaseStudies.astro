---
import { getCollection } from 'astro:content';

// Get all case studies from the content collection
const caseStudiesCollection = await getCollection('case-studies');

// Featured case studies to display in specific order (matching remote site)
const featuredCaseStudySlugs = ['dominos', 'kfc', 'moove', 'clear-bio'];

// Service categories for filter buttons
const serviceCategories = [
  { id: 'all', label: 'All' },
  { id: 'mobile-app-development', label: 'Mobile App Development' },
  { id: 'ux/ui-design', label: 'UX/UI Design' },
  { id: 'backend-development', label: 'Backend Development' },
  { id: 'data-analytics', label: 'Data Analytics' }
];

// Case studies data with images and logos matching staging.appvintech.com
const featuredCaseStudies = [
  {
    slug: 'dominos',
    data: {
      title: "Domino's Pizza - Pizza Delivery Service",
      subtitle: "Redefining Customer Journey in the Middle East",
      description: "Developed a cross-platform mobile delivery app that increased digital sales by 23% and improved customer satisfaction through intuitive design and real-time order tracking. The app features seamless ordering, real-time delivery tracking, personalized recommendations, and secure payment options. It supports multiple languages and currencies for the Middle Eastern market, with localized menu options and promotions.",
      client: "Domino's Pizza",
      industry: "Food & Beverage",
      services: ["Mobile App Development", "UX/UI Design", "Backend Development"],
      image: "https://staging.appvintech.com/wp-content/uploads/2024/06/Frame-1686552045.png", // Domino's image from staging site
      logo: "https://staging.appvintech.com/wp-content/uploads/2023/12/logo-2.webp", // Domino's logo from staging site
      featured: true,
      order: 1
    }
  },
  {
    slug: 'kfc',
    data: {
      title: "KFC - Fried Chicken Restaurant",
      subtitle: "Enhancing Customer Experience Across the Middle East",
      description: "Developed 7 localized KFC delivery apps across the Middle East, achieving 70% reduction in aggregator app dependency and significantly improving customer engagement. Each app was tailored to local preferences with country-specific menus, promotions, and payment methods. The solution included a centralized order management system, real-time kitchen integration, and advanced analytics for business intelligence.",
      client: "KFC (Americana Group)",
      industry: "Food & Beverage",
      services: ["Mobile App Development", "UX/UI Design", "Backend Development"],
      image: "https://staging.appvintech.com/wp-content/uploads/2024/06/Frame-1686552041-1.png", // KFC image from staging site
      logo: "https://staging.appvintech.com/wp-content/uploads/2023/12/logo.webp", // KFC logo from staging site
      featured: true,
      order: 2
    }
  },
  {
    slug: 'moove',
    data: {
      title: "Moove - Fleet Management Platform",
      subtitle: "Revolutionizing Fleet Operations with AI",
      description: "Created an AI-powered fleet management platform that optimized routes, reduced fuel consumption by 28%, and improved driver safety scores by 45% across enterprise fleets. The platform integrates with vehicle telematics systems to collect real-time data on vehicle performance, driver behavior, and environmental conditions. Advanced machine learning algorithms analyze this data to provide predictive maintenance alerts, optimize routing in real-time, and identify opportunities for operational improvements.",
      client: "Moove Technologies",
      industry: "Transportation & Logistics",
      services: ["Web Application", "Mobile App", "AI Integration", "IoT"],
      image: "https://staging.appvintech.com/wp-content/uploads/2024/06/Frame-1686552033-2.png", // Moove image from staging site
      logo: "https://staging.appvintech.com/wp-content/uploads/2024/06/moove-logo.png", // Moove logo from staging site
      featured: true,
      order: 3
    }
  },
  {
    slug: 'clear-bio',
    data: {
      title: "Clear.bio - Healthcare Analytics",
      subtitle: "Transforming Medical Data into Actionable Insights",
      description: "Developed a HIPAA-compliant analytics platform that helped healthcare providers reduce administrative costs by 32% and improve patient outcomes through data-driven decision making. The platform securely integrates with electronic health records (EHR) systems, medical devices, and billing systems to create a comprehensive view of patient care and operational efficiency. Advanced analytics and visualization tools help clinicians identify trends, predict patient risks, and optimize treatment protocols while maintaining strict data privacy and security standards.",
      client: "Clear.bio",
      industry: "Healthcare",
      services: ["Data Analytics", "Cloud Infrastructure", "Security & Compliance"],
      image: "https://staging.appvintech.com/wp-content/uploads/2024/06/Frame-1686552038.png", // Clear.bio image from staging site
      logo: "https://staging.appvintech.com/wp-content/uploads/2024/05/Clip-path-group.svg", // Clear.bio logo from staging site
      featured: true,
      order: 4
    }
  }
];

// Professional industry-specific images for case studies
const industryImages: Record<string, string> = {
  "Technology": "/images/case-studies/ai-customer-service.jpg",
  "Healthcare": "/images/case-studies/healthcare-digital-transformation.jpg",
  "Food & Beverage": "/images/case-studies/kfc.webp",
  "Transportation & Logistics": "/images/case-studies/gribb.webp",
  "Finance": "https://images.unsplash.com/photo-1563986768609-322da13575f3?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",
  "Retail": "https://images.unsplash.com/photo-1586880244406-556ebe35f282?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",
  "Manufacturing": "https://images.unsplash.com/photo-1581091226033-d5c48150dbaa?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",
  "Energy": "https://images.unsplash.com/photo-1473341304170-971dccb5ac1e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80"
};
---

<section id="case-studies" class="py-20 bg-gray-50 dark:bg-gray-800 relative overflow-hidden">
  <!-- Background pattern -->
  <div class="absolute inset-0 bg-grid-pattern opacity-5 dark:opacity-3"></div>

  <!-- Decorative elements -->
  <div class="absolute -bottom-20 -right-20 size-96 bg-accent-100 dark:bg-accent-900/20 rounded-full opacity-30 blur-3xl"></div>
  <div class="absolute -top-20 -left-20 size-96 bg-primary-100 dark:bg-primary-900/20 rounded-full opacity-30 blur-3xl"></div>

  <div class="container mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
    <div class="text-center max-w-3xl mx-auto mb-12">
      <!-- Section label -->
      <div class="flex justify-center mb-4">
        <div class="inline-flex items-center px-3 py-1 text-xs font-medium rounded-full bg-primary-100 text-primary-800 dark:bg-primary-900/30 dark:text-primary-300">
          <span class="w-2 h-2 bg-primary-500 rounded-full mr-2"></span>
          Our Proven Expertise
        </div>
      </div>

      <h2 class="section-title text-4xl md:text-5xl font-extrabold mb-8 text-center tracking-tight">
        Featured <span class="gradient-text">Case Studies</span>
      </h2>
      <div class="w-24 h-1 bg-gradient-to-r from-primary-500 to-secondary-500 mx-auto mb-8 rounded-full shadow-lg"></div>
      <p class="section-subtitle text-xl md:text-2xl text-gray-600 dark:text-gray-300 font-medium max-w-2xl mx-auto text-center mb-12 leading-relaxed">
        Explore how our AI-native solutions have delivered measurable business impact across industries.
      </p>
    </div>

    <!-- Service filter buttons -->
    <div class="flex flex-wrap justify-center gap-3 mb-12">
      {serviceCategories.map((category) => (
        <button
          class={`px-4 py-2 rounded-full text-sm font-medium transition-all ${
            category.id === 'all'
              ? 'bg-primary-600 text-white hover:bg-primary-700'
              : 'bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700'
          }`}
          data-filter={category.id}
        >
          {category.label}
        </button>
      ))}
    </div>

    <!-- Case studies grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
      {featuredCaseStudies.map((study, index) => (
        <div
          class="case-study-card bg-white dark:bg-gray-900 rounded-xl overflow-hidden shadow-lg hover:shadow-xl transition-all border border-gray-100 dark:border-gray-700 hover:border-primary-200 dark:hover:border-primary-800 group transform hover:-translate-y-1 duration-300 animate-in fade-in slide-in-from-bottom-5 flex flex-col"
          data-services={study.data.services ? study.data.services.map(s => s.toLowerCase().replace(/\s+/g, '-')).join(' ') : ''}
          style={`animation-delay: ${index * 100}ms; min-height: 600px;`}
        >
          <!-- Image with overlay -->
          <div class="h-48 relative overflow-hidden">

            <!-- Case study image -->
            <div class="absolute inset-0 overflow-hidden bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-800 dark:to-gray-900">
              {study.data.image ? (
                <img
                  src={study.data.image}
                  alt={study.data.title}
                  class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
                />
              ) : (
                <div class="w-full h-full bg-gradient-to-br from-primary-100 to-secondary-100 dark:from-primary-900/30 dark:to-secondary-900/30"></div>
              )}
            </div>

            <!-- Gradient overlay -->
            <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
          </div>

          <div class="p-6 flex flex-col flex-grow">
            <!-- Company logo -->
            <div class="flex items-center justify-center h-16 mb-4">
              {study.data.logo && (
                <img
                  src={study.data.logo}
                  alt={`${study.data.client} logo`}
                  class="h-full object-contain max-w-[180px]"
                />
              )}
            </div>

            <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-3 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors text-center">
              {study.data.title}
            </h3>

            <p class="text-gray-600 dark:text-gray-400 mb-4 text-sm">
              {study.data.description}
            </p>

            <!-- Services tags -->
            <div class="flex flex-wrap gap-2 mb-6">
              {study.data.services && study.data.services.slice(0, 3).map((service) => (
                <span class="px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded-md text-xs">
                  {service}
                </span>
              ))}
              {study.data.services && study.data.services.length > 3 && (
                <span class="px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded-md text-xs">
                  +{study.data.services.length - 3} more
                </span>
              )}
            </div>

            <div class="mt-auto"></div>

            <div class="flex justify-center">
              <a
                href={`/case-studies/${study.slug}`}
                class="inline-flex items-center text-primary-600 dark:text-primary-400 hover:text-primary-800 dark:hover:text-primary-300 font-medium group-hover:underline transition-all"
              >
              Click here for Inspiration and Accelerators
                <svg xmlns="http://www.w3.org/2000/svg" class="size-5 ml-1 transition-transform group-hover:translate-x-1" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M12.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd" />
                </svg>
              </a>
            </div>
          </div>
        </div>
      ))}
    </div>

    <div class="text-center mt-16">
      <a
        href="/case-studies"
        class="btn px-8 py-4 inline-flex items-center group transform transition-all duration-300 hover:-translate-y-1 rounded-full border-2 border-accent-600 text-accent-600 hover:text-white hover:bg-gradient-to-r hover:from-secondary-500 hover:to-secondary-600 hover:border-transparent hover:shadow-xl hover:shadow-secondary-500/30 dark:border-accent-500 dark:text-accent-400 dark:hover:text-white dark:hover:from-secondary-500 dark:hover:to-secondary-600 dark:hover:shadow-secondary-500/20"
      >
        <span class="font-semibold drop-shadow-md">View All Case Studies</span>
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2 group-hover:ml-3 transition-all duration-300" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H3a1 1 0 110-2h11.586l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd" />
        </svg>
      </a>
    </div>
  </div>
</section>

<script is:inline>
  // Service filter functionality
  document.addEventListener('DOMContentLoaded', () => {
    const filterButtons = document.querySelectorAll('[data-filter]');
    const caseStudyCards = document.querySelectorAll('.case-study-card');

    // Set initial active state
    const setActiveFilter = (activeFilter) => {
      filterButtons.forEach(button => {
        const isActive = button.getAttribute('data-filter') === activeFilter;

        if (isActive) {
          button.classList.remove('bg-gray-100', 'text-gray-700', 'dark:bg-gray-800', 'dark:text-gray-300');
          button.classList.add('bg-primary-600', 'text-white');
        } else {
          button.classList.remove('bg-primary-600', 'text-white');
          button.classList.add('bg-gray-100', 'text-gray-700', 'dark:bg-gray-800', 'dark:text-gray-300');
        }
      });
    };

    // Filter case studies
    const filterCaseStudies = (filter) => {
      if (filter === 'all') {
        caseStudyCards.forEach(card => {
          if (card instanceof HTMLElement) {
            card.style.display = 'block';
          }
        });
      } else {
        caseStudyCards.forEach(card => {
          const services = card.getAttribute('data-services') || '';
          if (card instanceof HTMLElement) {
            if (services.includes(filter)) {
              card.style.display = 'block';
            } else {
              card.style.display = 'none';
            }
          }
        });
      }
    };

    // Add click event listeners
    filterButtons.forEach(button => {
      button.addEventListener('click', () => {
        const filter = button.getAttribute('data-filter');
        if (filter) {
          setActiveFilter(filter);
          filterCaseStudies(filter);
        }
      });
    });
  });
</script>

<style>
  .bg-grid-pattern {
    background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%239C92AC' fill-opacity='0.2'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
  }
</style>


